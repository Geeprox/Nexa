# PRD V1: 分叉对话与图谱画布

## 背景
传统线性 ChatBot 在流式回答过程中无法即时分叉追问，长对话难以回溯与检索，导致研究与学习效率低。

## 目标
- 支持用户在回答任意片段处即时分叉并形成新的会话节点。
- 用图谱方式展示对话关系，支持拖拽、缩放、聚焦与快速回到根节点。
- 保持交互流畅，面向研究场景可长时间使用。

## 非目标
- 自由手绘白板。
- 自动章节生成 (V1 不实现)。
- 语义搜索。

## 目标用户
任何把 LLM 当作长期研究伙伴的用户，强调深度交流与知识沉淀。

## 用户故事
- 我在阅读回答时选中一段话，想立即追问并生成一个新分支。
- 我希望一眼看到当前分支在整棵对话树中的位置。
- 我想把画布缩放到根节点，快速定位并继续新的思路。

## 功能需求
- 选中回答片段后可点击“分叉追问”。
- 分叉节点应立即显示在图谱上，并与父节点连线。
- 图谱支持拖拽节点、缩放画布、平移画布。
- 节点可展开/折叠，支持聚焦当前分支。
- 可一键回到根节点。
- 节点显示摘要与状态标识 (例如是否未读/是否有分叉)。

## 交互流程
- 用户选中文本 -> 触发分叉 -> 新节点创建 -> 进入新节点对话。
- 用户点击节点 -> 切换到该分支的聊天视图。

## 数据需求
- 节点与边的持久化。
- 节点与消息、摘要、父子关系的映射。

## 约束
- 必须保证流畅拖拽与缩放体验。
- macOS 优先交付。

## 成功指标
- 分叉操作可在 1 秒内完成。
- 图谱拖拽与缩放保持 60fps。

## 风险
- 图谱渲染性能随节点数量上升。
- 交互复杂度过高影响易用性。

## 未决问题
- 节点初始布局策略是否采用自动布局。
- 节点折叠的默认规则。
